#:kivy 1.7.2
#:import Colors Config.WIDGET_COLORS
#:import Sizes Config.WIDGET_SIZES

#:import BeatCounter BpmCounter
#:import SimpleMsvController MsvController
#:import CustomWheel ColorMixer
#:import SceneMixer SceneMixer
#:import WidgetElements WidgetElements


<WidgetScreen>:
    canvas:
        Color:
            rgba: Colors.SCREEN_BACKGROUND
        Rectangle:
            pos: self.pos
            size: self.size

    WebTest:
        id: web

    BoxLayout:
        pos: root.pos
        size: root.size

        padding: Sizes.SCREEN_PADDING
        spacing: Sizes.SCREEN_SPACING

        orientation: 'vertical'

        GridLayout:
            pos: root.pos
            size: root.size
            size_hint: 1, 0.15
            spacing: Sizes.SCREEN_SPACING
            cols: 3

            BeatCounter:
                id: beat_a
                size_hint: 0.35, 1
                on_beat_value: wheel_a.bpm = args[1]; msvControl.setBpm(args[1], "A"); mixer_a.bpm = args[1]
                on_trigger: wheel_a.trigger = args[1]

            SimpleMsvController:
                id: msvControl
                size_hint: 0.5, 1

            BeatCounter:
                id: beat_b
                size_hint: 0.35, 1
                on_beat_value: wheel_b.bpm = args[1]; msvControl.setBpm(args[1], "B")
                on_trigger: wheel_b.trigger = args[1]



        GridLayout:
            pos: root.pos
            size: root.size
            size_hint: 1, 0.25
            spacing: Sizes.SCREEN_SPACING
            cols: 3

            CustomWheel:
                id: wheel_a
                size_hint: 0.40, 1
                on_color: web.color = args[1]

            Filler:
                size_hint: 0.2, 1

            CustomWheel:
                id: wheel_b
                size_hint: 0.40, 1

        GridLayout:
            pos: root.pos
            size: root.size
            size_hint: 1, 0.25
            spacing: Sizes.SCREEN_SPACING
            cols: 3

            FadePicker:
                id: fade_b
                size_hint: 0.15, 1
                on_step_size: wheel_a.steps_per_beat = args[1]; mixer_a.sceneTime = args[1]
                on_fade_time: wheel_a.fade_time_in_beats = args[1]; mixer_a.fadeTime = args[1]

            Filler:
                size_hint: 0.7, 1
                text: "Controller v.1.1"

            FadePicker:
                id: fade_a
                size_hint: 0.15, 1
                on_step_size: wheel_b.steps_per_beat = args[1]
                on_fade_time: wheel_b.fade_time_in_beats = args[1]

        GridLayout:
            pos: root.pos
            size: root.size
            size_hint: 1, 0.3
            spacing: Sizes.SCREEN_SPACING
            cols: 3

            SceneMixer:
                id: mixer_a
            Filler:
                size_hint: 0.3, 1
            SceneMixer:
                id: mixer_b
